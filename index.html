<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SURROGAT</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body{margin:0;background:#000;color:#fff;font-family:sans-serif;text-align:center;padding:30px 20px}
    h1{font-size:42px;margin:20px 0;background:linear-gradient(90deg,#00ff41,#b026ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    p{font-size:19px;opacity:0.9;line-height:1.5}
    .btn{background:linear-gradient(90deg,#00ff41,#b026ff);color:#000;font-weight:900;font-size:24px;padding:22px;border-radius:25px;border:none;width:95%;margin:20px auto;display:block;box-shadow:0 15px 40px rgba(0,255,65,0.5);cursor:pointer}
    .small{color:#0f0;font-size:15px;margin-top:-10px}
    video{width:100vw;height:100vh;object-fit:cover;background:#000}
  </style>
</head>
<body>

  <h1>SURROGAT</h1>
  <p>POV-стримы от первого лица</p>

  <button class="btn" id="free">Смотреть публичный стрим бесплатно</button>
  <button class="btn" id="private">Приватный суррогат (голосовые команды)</button>
  <button class="btn" id="carrier">Я носитель — начать стрим</button>

  <div id="menu" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:#000;z-index:10;padding:100px 20px">
    <h2 style="color:#0f0">Выбери время:</h2>
    <button class="btn" onclick="pay(10,1500)">10 минут — 1500 ⭐</button>
    <button class="btn" onclick="pay(30,3000)">30 минут — 3000 ⭐</button>
    <button class="btn" onclick="pay(60,5000)">60 минут — 5000 ⭐</button>
    <p class="small">платформа берёт 5%</p>
  </div>

  <script>
    const tg = Telegram.WebApp;
    tg.ready();
    tg.expand();

    // ТЕСТОВЫЙ ПУБЛИЧНЫЙ СТРИМ (я сейчас в эфире)
    document.getElementById('free').onclick = () => {
      document.body.innerHTML = `<video src="https://surrogat-test.pages.dev/stream.mp4" autoplay playsinline loop></video>`;
    };

    // ПРИВАТНЫЙ СУРРОГАТ
    document.getElementById('private').onclick = () => {
      document.getElementById('menu').style.display = 'block';
    };

    window.pay = (min, stars) => {
      document.getElementById('menu').style.display = 'none';
      tg.openInvoice({
        title: `Приватный суррогат — ${min} минут`,
        description: 'Ты один + голосовые команды носителю. Комиссия 5%',
        payload: 'private_' + min + 'min',
        provider_token: '',
        currency: 'XTR',
        prices: [{ label: `${min} минут`, amount: stars }]
      }, (success) => {
        if (success) {
          // 5% комиссии платформе
          console.log('Платформа получила:', stars * 0.05, '⭐');
          // Открываем приватный стрим (я сейчас в приватном режиме)
          document.body.innerHTML = `
            <video src="https://surrogat-test.pages.dev/private.mp4" autoplay playsinline loop></video>
            <div style="position:fixed;bottom:30px;left:20px;right:20px;background:rgba(0,0,0,0.8);padding:20px;border-radius:20px">
              <p style="margin:0;color:#0f0;font-size:18px">Говори голосом — я выполню!</p>
            </div>`;
          // Включаем микрофон для команд
          navigator.mediaDevices.getUserMedia({audio:true});
        }
      });
    };

    // НОСИТЕЛЬ
    document.getElementById('carrier').onclick = async () => {
      let facing = 'environment';
      if(confirm('Фронтальная камера? (Отмена = основная)')) facing = 'user';

      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: facing },
        audio: true
      });

      document.body.innerHTML = `
        <video id="v" autoplay playsinline muted style="transform:scaleX(-1)"></video>
        <div style="position:fixed;bottom:30px;left:20px;right:20px;background:rgba(255,0,0,0.7);padding:20px;border-radius:20px;color:#fff">
          Ты в эфире! Жд
